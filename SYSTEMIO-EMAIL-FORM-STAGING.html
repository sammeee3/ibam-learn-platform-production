<div style="max-width: 500px; margin: 20px auto; padding: 30px; background: linear-gradient(135deg, #059669 0%, #047857 30%, #065f46 70%, #064e3b 100%); border-radius: 16px; box-shadow: 0 20px 40px rgba(5, 150, 105, 0.3); text-align: center; font-family: Arial, sans-serif; border-top: 5px solid #10b981;">
    
    <div style="display: flex; justify-content: center; align-items: center; gap: 15px; margin-bottom: 20px; font-size: 36px;">
        <span style="animation: swim1 3s ease-in-out infinite;">ğŸŸ</span>
        <span style="animation: swim2 3s ease-in-out infinite 0.5s;">ğŸŸ</span>
        <span style="animation: swim3 3s ease-in-out infinite 1s;">ğŸŸ</span>
    </div>
    
    <style>
        @keyframes swim1 {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-8px) rotate(5deg); }
        }
        @keyframes swim2 {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-6px) rotate(-3deg); }
        }
        @keyframes swim3 {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(8deg); }
        }
    </style>
    
    <div style="background: rgba(16, 185, 129, 0.2); color: #10b981; padding: 8px 16px; border-radius: 20px; font-size: 12px; margin-bottom: 20px; border: 1px solid rgba(16, 185, 129, 0.3); font-weight: bold;">
        ğŸ§ª STAGING ENVIRONMENT - FOR TESTING ONLY
    </div>
    
    <h2 style="color: #f8fafc; margin-bottom: 10px; font-size: 24px; font-weight: bold;">Access IBAM Course (Staging)</h2>
    
    <p style="color: #e2e8f0; margin-bottom: 20px; font-size: 16px;">Testing environment for development</p>
    
    <div style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 15px; border-radius: 8px; margin-bottom: 25px; border-left: 4px solid #f59e0b;">
        <p style="color: #92400e; margin: 0; font-size: 14px; font-weight: bold;">ğŸ§ª This is the STAGING version for testing. Use any email for testing purposes.</p>
    </div>
    
    <form id="ibamAccessForm" style="margin-bottom: 20px;">
        <div style="margin-bottom: 15px;">
            <label style="display: block; color: #f1f5f9; font-weight: bold; margin-bottom: 8px; text-align: left;">Enter Test Email:</label>
            <input 
                type="email" 
                id="ibamEmail" 
                placeholder="test@example.com"
                required
                style="width: 100%; padding: 15px; border: 2px solid #475569; border-radius: 8px; font-size: 16px; box-sizing: border-box; transition: all 0.3s ease; background: #f8fafc; color: #1e293b;"
                onfocus="this.style.borderColor='#10b981'; this.style.boxShadow='0 0 0 3px rgba(16, 185, 129, 0.2)'; this.style.background='#ffffff'"
                onblur="this.style.borderColor='#94a3b8'; this.style.boxShadow='none'; this.style.background='#f8fafc'"
            >
            <p style="color: #cbd5e1; font-size: 13px; margin: 5px 0 0 0; text-align: center;">This is staging - you can use any email for testing</p>
            <p style="color: #a7f3d0; font-size: 12px; margin: 8px 0 0 0; text-align: center; font-weight: bold;">âœ… STAGING: Test accounts will be created automatically</p>
        </div>
        
        <button 
            type="submit" 
            id="ibamSubmitBtn"
            style="width: 100%; background: linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%); color: white; border: none; padding: 18px 24px; font-size: 18px; font-weight: bold; border-radius: 25px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4); text-shadow: 0 1px 2px rgba(0,0,0,0.2);"
            onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 12px 30px rgba(16, 185, 129, 0.6)'; this.style.background='linear-gradient(135deg, #34d399 0%, #10b981 50%, #059669 100%)'"
            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 25px rgba(16, 185, 129, 0.4)'; this.style.background='linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%)'"
        >
            ğŸŸ Access Staging Course
        </button>
    </form>
    
    <div style="background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%); padding: 15px; border-radius: 8px; border-left: 4px solid #10b981;">
        <p style="color: #065f46; margin: 0; font-size: 13px; font-weight: 600;">
            <strong>ğŸ§ª Staging Environment:</strong> This connects to the staging database and is safe for testing. No real user data will be affected.
        </p>
    </div>
    
</div>

<script>
document.getElementById('ibamAccessForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const email = document.getElementById('ibamEmail').value.trim();
    const button = document.getElementById('ibamSubmitBtn');
    
    if (!email || !email.includes('@')) {
        alert('Please enter a valid email address');
        return;
    }
    
    // Update button
    const originalText = button.innerHTML;
    button.innerHTML = 'ğŸ§ª Opening Staging...';
    button.disabled = true;
    
    // Save email for testing
    try {
        localStorage.setItem('ibam-staging-email', email);
    } catch (e) {}
    
    // Create staging access URL - now working with authentication disabled
    const accessUrl = 'https://ibam-learn-platform-staging-v2-1k0mdne9l.vercel.app/api/auth/sso?email=' + 
                      encodeURIComponent(email) + 
                      '&token=ibam-systeme-secret-2025&source=systemio-staging';
    
    console.log('ğŸ§ª Accessing IBAM staging for:', email);
    
    // Open staging course
    try {
        const courseWindow = window.open(accessUrl, '_blank', 'width=1200,height=800');
        if (courseWindow) {
            courseWindow.focus();
            button.innerHTML = 'âœ… Staging Opened!';
        } else {
            window.location.href = accessUrl;
        }
    } catch (error) {
        window.location.href = accessUrl;
    }
    
    // Reset button after 3 seconds
    setTimeout(() => {
        button.innerHTML = originalText;
        button.disabled = false;
    }, 3000);
});

// Auto-fill saved staging email
window.addEventListener('load', function() {
    try {
        const savedEmail = localStorage.getItem('ibam-staging-email');
        if (savedEmail) {
            document.getElementById('ibamEmail').value = savedEmail;
        } else {
            // Default test email for staging
            document.getElementById('ibamEmail').value = 'staging-test@ibam.org';
        }
    } catch (e) {}
});
</script>